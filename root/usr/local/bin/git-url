#!/usr/bin/env python3

from giturlparse import parse
import sys
import os

if os.path.exists(sys.argv[1]) or sys.argv[1].startswith(".") or sys.argv[1].startswith("/"):
    if len(sys.argv) > 1:
        sys.exit(0)
    print(sys.argv[1])
    sys.exit(0)

try:
    url, attr = sys.argv[1:3]
except ValueError:
    # user|branch|domain|groups_path|owner|path|path_raw|pathname|platform|port|protocol|protocols|repo|url
    attrs = 'user|host|owner|groups|repo|path|protocol|branch|url|url2ssh'
    print(f'Usage: {sys.argv[0]} GIT-URL [{attrs}]', file=sys.stderr)
    print('See https://github.com/nephila/giturlparse for detail', file=sys.stderr)
    sys.exit(1)

if attr == 'groups':
    attr = 'groups_path'

if attr in ['path', 'path_raw']:
    attr = 'pathname'

p = parse(url)
value = getattr(p, attr)

if attr in ['host', 'domain']:
    if '/' in value:
        value = value[:value.index('/')]
    if ':' in value:
        value = value[:value.index(':')]

print(value)
